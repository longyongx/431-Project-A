chr_2020 <- chr_2020 %>%
mutate(fipscode = str_pad(fipscode, 5, pad = "0"),
state = factor(state))
chr_2020 <- chr_2020 %>%
mutate(uninsured_adults = uninsured_adults * 100, some_college = some_college * 100)
chr_2020 <- chr_2020 %>%
mutate(food_binary = case_when(is.na(food_environment_index) ~ "other",
food_environment_index < median(food_environment_index, na.rm = TRUE) ~ "other",
TRUE ~ "high"),
food_binary = factor(food_binary))
mosaic::favstats(food_environment_index ~ food_binary, data = chr_2020) %>%
kable(digits = 3)
chr_2020 <- chr_2020 %>%
mutate(income_cat = case_when(
median_household_income < 45000 ~ "1_lower",
median_household_income < 55000 ~ "2_lower_middle",
median_household_income < 65000 ~ "3_upper_middle",
TRUE ~ "4_upper"),
income_cat = factor(income_cat))
mosaic::favstats(median_household_income ~ income_cat, data = chr_2020) %>%
kable(digits = 3)
str(chr_2020)
chr_2020
Hmisc::describe(chr_2020)
chr_2020 %>%
summarize(across(life_expectancy:food_environment_index, ~sum(is.na(.)))) %>%
kable()
mosaic::favstats(food_environment_index ~ state, data = chr_2020) %>%
select(state, n, missing) %>%
mutate(pct_available = 100*(n - missing)/n) %>%
kable()
chr_2020 %>%
summarize(across(life_expectancy:food_environment_index, ~n_distinct(.))) %>%
kable()
chr_2020 %>% tabyl(food_binary) %>% kable()
chr_2020 %>% tabyl(income_cat) %>% kable()
saveRDS(chr_2020, file = "chr_2020_Patrick_Wu_Long_Vu.Rds")
life_college <- chr_2020 %>%
select(state, county, life_expectancy, some_college) %>%
filter(complete.cases(life_expectancy, some_college))
life_college
life_college %>%
filter(state == 'OH' & county == 'Cuyahoga County') %>% kable()
sessionInfo()
life_college %>%
filter(state == 'OH' & county == 'Cuyahoga County') %>% kable(digits = 2)
life_college %>%
filter(state == 'OH' & county == 'Cuyahoga County') %>% kable(digits = 2)
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
```{r}
ggplot(data = life_college, aes(x = log(some_college), y = log(life_expectancy))) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
car::boxcox(life_college$life_expectancy ~ life_college$some_college)
car::boxCox(life_college$life_expectancy ~ life_college$some_college)
car::boxCox(life_college$life_expectancy ~ life_college$some_college)
car::powerTransform(life_college$life_expectancy ~ life_college$some_college)
car::boxCox(life_college$life_expectancy ~ life_college$some_college)
car::powerTransform(life_college$life_expectancy ~ life_college$some_college)
car::testTransform(powerTransform(life_college$life_expectancy ~ life_college$some_college), 1)
boxCox(life_college$life_expectancy ~ life_college$some_college)
library(car)
library(janitor)
library(magrittr)
library(tidyverse)
boxCox(life_college$life_expectancy ~ life_college$some_college)
powerTransform(life_college$life_expectancy ~ life_college$some_college)
testTransform(powerTransform(life_college$life_expectancy ~ life_college$some_college), 1)
testTransform(powerTransform(life_college$life_expectancy ~ life_college$some_college), 2)
boxCox(life_college$life_expectancy ~ life_college$some_college)
powerTransform(life_college$life_expectancy ~ life_college$some_college)
testTransform(powerTransform(life_college$life_expectancy ~ life_college$some_college), 0)
testTransform(powerTransform(life_college$life_expectancy ~ life_college$some_college), 1)
testTransform(powerTransform(life_college$life_expectancy ~ life_college$some_college), 2)
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
geom_smooth(method = 'loess', color = 'dodgerblue', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
square_life <- life_college %>%
mutate(life_expectancy = life_expectancy^2)
ggplot(data = square_life, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Squared average life expectancy (years^2)')
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_boxplot()
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_boxplot() +
coord_flip()
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college)) +
geom_boxplot() +
coord_flip()
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college)) +
geom_boxplot()
lm.life_college <- lm(life_college$life_expectancy ~ life_college$some_college)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = life_college$some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
?augment
library(car)
library(broom)
library(janitor)
library(magrittr)
library(tidyverse)
lm.life_college <- lm(life_college$life_expectancy ~ life_college$some_college)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = life_college$some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
lm.life_college <- lm(life_college$life_expectancy ~ life_college$some_college)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = life_college$some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
lm.life_college <- lm(life_college$life_expectancy ~ life_college$some_college)
lm.life_college
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = life_college$some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college)) +
geom_boxplot()
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_qq() +
geom_qq_line()
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college)) +
geom_boxplot()
ggplot(data = life_college, aes(sample = life_expectancy ~ some_college) +
geom_qq() +
geom_qq_line()
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college)) +
geom_boxplot()
ggplot(data = life_college, aes(sample = life_expectancy) +
geom_qq() +
geom_qq_line()
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college)) +
geom_boxplot()
ggplot(data = life_college, aes(sample = life_expectancy ~ some_college))+
geom_qq() +
geom_qq_line()
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college)) +
geom_boxplot()
ggplot(data = life_college, aes(sample = life_expectancy))+
geom_qq() +
geom_qq_line()
lm.life_college <- lm(life_college$life_expectancy ~ life_college$some_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = life_college$some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
glance(lm.life_college) %>% select(r.squared, p.value, sigma) %>% kable
library(knitr)
library(rmdformats)
## Global options
options(max.print="75")
opts_chunk$set(comment=NA)
opts_knit$set(width=75)
ggplot(data = life_college, aes(x = some_college, y = life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
boxCox(life_college$life_expectancy ~ life_college$some_college)
powerTransform(life_college$life_expectancy ~ life_college$some_college)
ggplot(data = life_college, aes(x = some_college, y = log(life_expectancy)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
ggplot(data = life_college, aes(x = some_college, y = log(life_expectancy))) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
labs(x = '% of adults 25-44 with some college',
y = 'Average life expectancy (years)')
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
glance(lm.life_college) %>% select(r.squared, p.value, sigma) %>% kable
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
p1 %>%
ggplot(., aes(y = .resid)) +
geom_boxplot()
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
lm.life_college %>%
augment() %>%
ggplot(., aes(y = .resid)) +
geom_boxplot()
glance(lm.life_college) %>% select(r.squared, p.value, sigma) %>% kable
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
lm.life_college %>%
augment() %>%
ggplot(., aes(y = .resid)) +
geom_boxplot() +
coord_flip()
glance(lm.life_college) %>% select(r.squared, p.value, sigma) %>% kable
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
lm.life_college %>%
augment() %>%
ggplot(., aes(y = .resid)) +
geom_boxplot() +
coord_flip()
lm.life_college %>%
augment() %>%
ggplot(., sample = some_college) +
geom_qq() +
geom_qq_line()
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
lm.life_college %>%
augment() %>%
ggplot(., aes(y = .resid)) +
geom_boxplot() +
coord_flip()
lm.life_college %>%
augment() %>%
ggplot(., aes(sample = some_college)) +
geom_qq() +
geom_qq_line()
glance(lm.life_college) %>% select(r.squared, p.value, sigma) %>% kable
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p1 <- augment(lm.life_college) %>%
ggplot(., aes(x = some_college, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
p1
lm.life_college %>%
augment() %>%
ggplot(., aes(y = .resid)) +
geom_boxplot() +
coord_flip()
lm.life_college %>%
augment() %>%
ggplot(., aes(sample = .resid)) +
geom_qq() +
geom_qq_line()
glance(lm.life_college) %>% select(r.squared, p.value, sigma) %>% kable
lm.life_college <- lm(life_expectancy ~ some_college, data = life_college)
tidy(lm.life_college) %>% kable(digits = 2)
p0 <- augment(lm.life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p2 <- ggplot(data = p0, aes(x = .resid)) +
geom_histogram(aes(y = stat(density)),
bins = 20, fill = "tomato", col = "yellow") +
stat_function(fun = dnorm,
args = list(mean = mean(lm.life_college$.resid),
sd = sd(lm.life_college$.resid)),
col = "black", lwd = 1.5) +
labs(title = "Hist + Normal Density: Residuals")
p3 <- ggplot(data = p0, aes(x = resid.))
geom_boxplot(aes(x = .resid)) +
labs(title = 'Boxplot of Resid')
p0 <- augment(lm.life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p2 <- ggplot(data = p0, aes(x = .resid)) +
geom_histogram(aes(y = stat(density)),
bins = 20, fill = "tomato", col = "yellow") +
stat_function(fun = dnorm,
args = list(mean = mean(lm.life_college$.resid),
sd = sd(lm.life_college$.resid)),
col = "black", lwd = 1.5) +
labs(title = "Hist + Normal Density: Residuals")
p3 <- ggplot(data = p0, aes(x = resid.)) +
geom_boxplot(aes(x = .resid)) +
labs(title = 'Boxplot of Resid')
p1 + (p2 / p3 + plot_layout(heights = c(4,1)))
p0 <- augment(lm.life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p2 <- ggplot(data = p0, aes(x = .resid)) +
geom_histogram(aes(y = stat(density)),
bins = 20, fill = "tomato", col = "yellow") +
stat_function(fun = dnorm,
args = list(mean = mean(lm.life_college$.resid),
sd = sd(lm.life_college$.resid)),
col = "black", lwd = 1.5) +
labs(title = "Hist + Normal Density: Residuals")
p3 <- ggplot(data = p0, aes(x = resid.)) +
geom_boxplot(aes(x = .resid)) +
labs(title = 'Boxplot of Resid')
mosaic::favstats(~ .resid, data = p0) %>% kable(digits = 1)
p0 <- augment(lm.life_college, data = life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p2 <- ggplot(data = p0, aes(x = .resid)) +
geom_histogram(aes(y = stat(density)),
bins = 20, fill = "tomato", col = "yellow") +
stat_function(fun = dnorm,
args = list(mean = mean(lm.life_college$.resid),
sd = sd(lm.life_college$.resid)),
col = "black", lwd = 1.5) +
labs(title = "Hist + Normal Density: Residuals")
p3 <- ggplot(data = p0, aes(x = resid.)) +
geom_boxplot(aes(x = .resid)) +
labs(title = 'Boxplot of Resid')
p1 + (p2 / p3 + plot_layout(heights = c(4,1)))
p0 <- augment(lm.life_college, data = life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p2 <- ggplot(data = p0, aes(x = .resid)) +
geom_histogram(aes(y = stat(density)),
bins = 20, fill = "tomato", col = "yellow") +
stat_function(fun = dnorm,
args = list(mean = mean(lm.life_college$.resid),
sd = sd(lm.life_college$.resid)),
col = "black", lwd = 1.5) +
labs(title = "Hist + Normal Density: Residuals")
p3 <- ggplot(data = p0, aes(x = resid.)) +
geom_boxplot(aes(x = .resid)) +
labs(title = 'Boxplot of Resid')
mosaic::favstats(~ .resid, data = p0) %>% kable(digits = 1)
View(p0)
View(p0)
View(p1)
View(p1)
p0 <- augment(lm.life_college, data = life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p0 <- augment(lm.life_college, data = life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p0 <- augment(lm.life_college, data = life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p1
library(car)
library(broom)
library(janitor)
library(magrittr)
library(patchwork)
library(tidyverse)
p0 <- augment(lm.life_college, data = life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p2 <- ggplot(data = p0, aes(x = .resid)) +
geom_histogram(aes(y = stat(density)),
bins = 20, fill = "tomato", col = "yellow") +
stat_function(fun = dnorm,
args = list(mean = mean(lm.life_college$.resid),
sd = sd(lm.life_college$.resid)),
col = "black", lwd = 1.5) +
labs(title = "Hist + Normal Density: Residuals")
p3 <- ggplot(data = p0, aes(x = resid.)) +
geom_boxplot(aes(x = .resid)) +
labs(title = 'Boxplot of Resid')
p1 + (p2 / p3 + plot_layout(heights = c(4,1)))
mosaic::favstats(~ .resid, data = p0) %>% kable(digits = 1)
p0 <- augment(lm.life_college, data = life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p2 <- ggplot(data = p0, aes(x = .resid)) +
geom_histogram(aes(y = stat(density)), bins = 20, fill = "tomato", col = "yellow") +
stat_function(fun = dnorm, args = list(mean = mean(p0$.resid), sd = sd(p0$.resid)), col = "black", lwd = 1.5) +
labs(title = "Hist + Normal Density: Residuals")
p3 <- ggplot(data = p0, aes(x = resid.)) +
geom_boxplot(aes(x = .resid)) +
labs(title = 'Boxplot of Resid')
p1 + (p2 / p3 + plot_layout(heights = c(4,1)))
mosaic::favstats(~ .resid, data = p0) %>% kable(digits = 1)
p0 <- augment(lm.life_college, data = life_college)
p1 <- ggplot(data = p0, aes(sample = .resid)) +
geom_qq() +
geom_qq_line() +
labs(title = 'Lm.life_college Residuals')
p2 <- ggplot(data = p0, aes(x = .resid)) +
geom_histogram(aes(y = stat(density)), bins = 20) +
stat_function(fun = dnorm, args = list(mean = mean(p0$.resid), sd = sd(p0$.resid)), col = "black", lwd = 1.5) +
labs(title = "Hist + Normal Density: Residuals")
p3 <- ggplot(data = p0, aes(x = resid.)) +
geom_boxplot(aes(x = .resid)) +
labs(title = 'Boxplot of Resid')
p1 + (p2 / p3 + plot_layout(heights = c(4,1)))
mosaic::favstats(~ .resid, data = p0) %>% kable(digits = 1)
ggplot(data = p0, aes(x = .fitted, y = resid.)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
ggplot(data = p0, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_smooth(method = 'lm', formula = y ~ x, se = FALSE)
